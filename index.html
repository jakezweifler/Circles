<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apollonian Gasket</title>
    <style>
        body {
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: white;
        }
        canvas {
            background-color: white;
            border: 1px solid black;
        }
    </style>
</head>
<body>
    <canvas id="myCanvas"></canvas>

    <script>
        const canvas = document.getElementById('myCanvas');
        const ctx = canvas.getContext('2d');
        
        // Set canvas size
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        
        // Function to draw a circle
        function drawCircle(x, y, radius) {
            ctx.beginPath();
            ctx.arc(x, y, radius, 0, Math.PI * 2, false);
            ctx.strokeStyle = "black";
            ctx.stroke();
            ctx.closePath();
        }

        // Recursive function to pack circles
        function packCircles(parentCircle, depth) {
            if (depth > 4) return; // Limit recursion depth to avoid infinite loops
            
            // Find the radius for child circles
            let radius = parentCircle.radius / 2;

            // Draw circles tangent to the parent circle
            for (let i = 0; i < 3; i++) {
                let angle = Math.random() * Math.PI * 2;
                let x = parentCircle.x + (parentCircle.radius - radius) * Math.cos(angle);
                let y = parentCircle.y + (parentCircle.radius - radius) * Math.sin(angle);
                let childCircle = { x, y, radius };
                
                // Draw the circle
                drawCircle(x, y, radius);

                // Recursively add smaller circles
                packCircles(childCircle, depth + 1);
            }
        }

        // Random initial large circle
        let outerCircle = {
            x: canvas.width / 2,
            y: canvas.height / 2,
            radius: Math.min(canvas.width, canvas.height) * 0.4
        };

        // Draw the outer circle
        drawCircle(outerCircle.x, outerCircle.y, outerCircle.radius);

        // Randomize the first two circles inside the outer circle
        let circle1 = {
            x: outerCircle.x + Math.random() * (outerCircle.radius / 2),
            y: outerCircle.y + Math.random() * (outerCircle.radius / 2),
            radius: Math.random() * outerCircle.radius / 3
        };

        let circle2 = {
            x: outerCircle.x - Math.random() * (outerCircle.radius / 2),
            y: outerCircle.y - Math.random() * (outerCircle.radius / 2),
            radius: Math.random() * outerCircle.radius / 3
        };

        // Draw the first two circles
        drawCircle(circle1.x, circle1.y, circle1.radius);
        drawCircle(circle2.x, circle2.y, circle2.radius);

        // Calculate the third circle (tangent to the first two and the outer circle)
        // For simplicity, we'll approximate this by placing it tangent to circle1 and circle2

        let thirdCircleRadius = (circle1.radius + circle2.radius) / 2;
        let thirdCircle = {
            x: (circle1.x + circle2.x) / 2,
            y: (circle1.y + circle2.y) / 2,
            radius: thirdCircleRadius
        };

        // Draw the third circle
        drawCircle(thirdCircle.x, thirdCircle.y, thirdCircle.radius);

        // Recursively pack smaller circles
        // packCircles(outerCircle, 0);
    </script>
</body>
</html>
